\begin{example}
	Существует ли множество, неизмеримое по Лебегу? К сожалению, да. Рассмотрим отрезок $[0; 1]$ и введём отношение эквивалентности на нём:
	\[
		x \sim y \Lra (x - y) \in \Q
	\]
	Так как это действительно отношение эквивалентности, то отрезок $[0; 1]$ разбивается на классы эквивалентности:
	\[
		[0; 1] = \bscup_{\alpha} K_\alpha
	\]
	Пусть $E$ - это множество, которое образовано из элементов различных классов (по одному из каждого. Здесь мы воспользовались аксиомой выбора). Занумеруем все рациональные числа отрезка $[-1; 1]$:
	\[
		[-1; 1] \cap \Q = \{r_n\}_{n = 1}^\infty
	\]
	Предположим, что $E$ измеримо по Лебегу. Тогда
	\[
		\forall m \in \N\ \ E_m := \{y \colon y = x + r_m, x \in E\}
	\]
	тоже измеримы по лебегу, причём $\forall m \in \N\ \mu(E_m) = \mu(E)$.
	
	Докажем, что $\forall k \neq j\ E_k \cap E_j = \emptyset$. От противного, пусть $y_0 \in E_k \cap E_j$. В таком случае
	\[
		y_0 = x_k + r_k = x_j + r_j,\ x_k \in E,\ x_j \in E
	\]
	Если переместить иксы в одну сторону, то получится интересный факт:
	\[
		x_j - x_k = r_k - r_j \in \Q \Lra x_j \sim x_k
	\]
	Но такого быть не может по определению множества $E$. Теперь, возьмём произвольный $y \in [0; 1]$. Тогда $\exists \alpha_0 \such y \in K_{\alpha_0}$. Более того, $\exists x \in E \cap K_{\alpha_0}$. Стало быть
	\[
		\exists m \in \N \such y = x + r_m \Ra y \in E_m
	\]
	В итоге, мы имеем следующую цепочку вложений и можем воспользоваться свойствами мер:
	\[
		[0; 1] \subset \bscup_{m = 1}^\infty E_m \subset [-1; 2] \Lora 1 \le \sum_{m = 1}^\infty \mu(E_m) = \sum_{m = 1}^\infty \mu(E) \le 3
	\]
	Бесконечная сумма одинаковых неотрицательных чисел должна быть зажата среди двух положительных, а такого быть не может.
\end{example}

\begin{note}
	В примере выше вместо $[0; 1]$ можно взять любое множество $A \subset \R \colon 0 < \mu(A) < \infty$. Просто в паре мест понадобится заменить $[0; 1]$ на $A$. Другими словами, это означает, что из любого множества конечной меры можно выбрать неизмеримое подмножество.
\end{note}

\subsection{Измеримые функции}

\begin{note}
	В этом параграфе мы будем использовать только меру Лебега, поэтому слово <<Лебега>> будем опускать.
\end{note}

\begin{definition}
	\textit{Лебеговым множеством функции} $f \colon E \to \R,\ E \subset \R^n$ называется множество
	\[
		E_a(f) = \{x \in E \colon f(x) < a\},\ a \in \R
	\]
\end{definition}

\begin{definition}
	Функция $f \colon E \to \R,\ E \subset \R^n$ и $E$ - измеримое множество, называется \textit{измеримой}, если $\forall a \in \R$ множество $E_a(f)$ измеримо.
\end{definition}

\begin{theorem} (Эквивалентное определение измеримости функций)
	Совокупность измеримых функций не изменится, если в определении лебегова множества заменить знак $<$ на любой из знаков $\le$, $\ge$, $>$.
\end{theorem}

\begin{proof}
	Знаки $\ge$ и $<$, а также $\le$, $>$ дают эквивалентные определения, так как, например, в первой паре есть связь (а дополнение измеримо тогда и только тогда, когда измеримо исходное множество)
	\[
		\{x \in E \colon f(x) \ge a\} = E \bs E_a(f)
	\]
	Докажем, что измеримость $\{x \in E \colon f(x) \le a\}$ совпадает с измеримостью $E_a(f)$. Заметим следующие равенства:
	\[
		\{x \in E \colon f(x) \le a\} = \bigcap_{m = 1}^\infty E_{a + \frac{1}{m}}(f) \quad E_a(f) = \bigcup_{m = 1}^\infty \left\{x \in E \colon f(x) \le a - \frac{1}{m}\right\}
	\]
	Случай справа (когда мы принимает измеримость с $\le$ при любом $a \in \R$) очевиден из свойств мер. Про левый же отметим одну вещь:
	\[
		E_{a + \frac{1}{m}}(f) = \left\{x \in E \colon f(x) < a + \frac{1}{m}\right\} \supset E_{a + \frac{1}{m + 1}} = \left\{x \in E \colon f(x) < a + \frac{1}{m + 1}\right\}
	\]
	Иначе говоря
	\[
		\bigcap_{m = 1}^\infty E_{a + \frac{1}{m}}(f) = \liml_{m \to \infty} E_{a + \frac{1}{m}}(f)
	\]
	а про измеримость предела теорема тоже была.
\end{proof}

\begin{note}
	Из определения следует, что любая непрерывная на измеримом множестве $E$ функция измерима. Действительно, все лебеговы множества в таком случае являются прообразами открытых в $E$ множеств. Открытость в $E$ означает, что прообраз является пересечением $E$ и какого-то открытого множества. Оба измеримы, поэтому пересечение тоже измеримо.
\end{note}

\begin{theorem} (Арифметические операции с измеримыми функциями) \label{arithmMF}
	Имеет место 2 свойства:
	\begin{enumerate}
		\item Если $f \colon \R \to \R$ непрерывна на множестве значений измеримой на $E \subset \R^n$ функции $g$, то $f \circ g$ измерима.
		
		\item Если $f, g$ измеримы на $E$, то $f \pm g$, $f \cdot g$ и (на своей области определения) $f / g$ измеримы.
	\end{enumerate}
\end{theorem}

\begin{proof}~
	\begin{enumerate}
		\item Рассмотрим лебегово множество $E_a(f \circ g)$:
		\[
			E_a(f \circ g) = \{x \in E \colon f(g(x)) < a\}
		\]
		Коль скоро $f$ непрерывна на $g(E)$, то
		\[
			f^{-1}(-\infty; a) = G \cap g(E), \text{ где $G$ - открытое множество}
		\]
		По теореме о структуре открытых множеств $G = \bscup_{m = 1}^\infty \gJ_m$ - объединение промежутков. Отсюда прообраз $f^{-1}(-\infty; a)$ можно записать так:
		\[
			f^{-1}(-\infty; a) = \bscup_{m = 1}^\infty (\gJ_m \cap g(E))
		\]
		Наконец, распишем прообраз $(f \circ g)^{-1}(-\infty; a)$:
		\[
			(f \circ g)^{-1}(-\infty; a) = \{x \in E \colon g(x) \in f^{-1}(-\infty; a)\} = \bscup_{m = 1}^\infty \{x \in E \colon g(x) \in \gJ_m\}
		\]
		Каждое множество в объединении будет измеримо, коль скоро представимо через счётное число операций над $E_a(g)$. Значит, дизъюнктное объединение тоже измеримо, что устанавливает измеримость $f \circ g$.
		
		\item Распишем лебегово множество для $f + g$:
		\begin{multline*}
			E_a(f + g) = \{x \in E \colon f(x) + g(x) < a\} = \{x \in E \colon f(x) < a - g(x)\} =
			\\
			\bigcup_{r \in \Q} \{x \in E \colon f(x) < r \wedge r < a - g(x)\} = \bigcup_{r \in \Q} E_r(f) \cap E_{a - r}(g)
		\end{multline*}
		Для умножения достаточно помнить трюк (квадрат является непрерывной функцией, а тут у нас композиция и можно применить уже доказанную часть):
		\[
			(f \cdot g)(x) = \frac{(f(x) + g(x))^2 - (f(x) - g(x))^2}{4}
		\]
		Для деления аналогично: композиция $1 / x$ - непрерывной на области определения функции и измеримой $g$.
	\end{enumerate}
\end{proof}

\begin{definition}
	\textit{Характеристической функцией} (или же \textit{индикатором}) множества $A$ называется следующая функция:
	\[
		\chi_A(x) = \System{
			&{1,\ x \in A}
			\\
			&{0,\ x \notin A}
		}
	\]
\end{definition}

\begin{proposition}
	$E \subset \R^n$ - измеримо $\Lra$ $\chi_E$ - измеримая функция
\end{proposition}

\begin{proof}
	Действительно, посмотрим на то, чем является $E_a(\chi_E)$ в зависимости от $a$:
	\[
		E_a(\chi_E) = \System{
			&{\R^n,\ a > 1}
			\\
			&{\R^n \bs E,\ 0 < a \le 1}
			\\
			&{\emptyset, a \le 0}
		}
	\]
	Из этой записи уже очевидна эквивалентность условий.
\end{proof}

\begin{example} (Канторова лестница)
	Напомним вид канторова множества:
	\[
		C = [0; 1] \bs \bigcup_{m = 1}^\infty \gJ_m
	\]
	где $\gJ_1 = (1/2; 2/3), \gJ_2 = (1/9; 2/9) \sqcup (7/9; 8/9), \ldots$
	
	Определим функцию $\overline{\phi}$ в концах интервалов из $\gJ_m$, то есть на подмножестве $E = \{p/3^m \colon 0 \le p \le 3^m, m \in \N\}$.
	
	\textcolor{red}{Сюда нужно картинку с 50:00 21 лекции весны 2022. Если объяснять на пальцах, то значение функции в границе интервала = среднему арифметическому концов интервала, в которых он вложен. При этом полагается $\overline{\phi}(0) = 0$ и $\overline{\phi}(1) = 1$.}
	
	Её множество значений - это $F = \{q / 2^m \colon 0 \le q \le 2^m,\ m \in \N\}$. Теперь, мы можем определить непосредственно $\phi(x)$ как функцию следующего вида:
	\[
		\phi(x) = \sup_{y \in E,\ y \le x} \overline{\phi}(y)
	\]
	$\phi(x)$ называется \textit{канторовой лестницой}, по понятным причинам. Исходя из определения, она является неубывающей. Более того, непрерывной. Это можно доказать от противного: пусть $x_0 \in [0; 1]$ - точка разрыва первого рода. Тогда множество значений $\phi$ не содержит значений из $(\phi(x_0 - 0); \phi(x_0 + 0)) \bs \{\phi(x_0)\}$. Но $F$ всюду плотно - противоречие.
	
	А что можно сказать про дифференцируемость канторовой лестницы? Мы уже знаем, что $\mu(C) = 0$. Значит, $\mu([0; 1] \bs C) = 1$. При этом
	\[
		\forall x \in [0; 1] \bs C \quad \phi'(x) = 0
	\]
	По математическим определениям это означает, что $\phi(x)$ дифференцируема \textit{почти всюду} (то есть за исключением множества нулевой меры).
\end{example}

\begin{example} (Контрпример к пункту 1 теоремы \ref{arithmMF})
	Существуют измеримая функция $f \colon \R \to \R$ и непрерывная $g \colon E \to \R$ такие, что $f \circ g$ неизмерима.
	
	Рассмотрим $\psi(x) = \frac{1}{2}(\phi(x) + x)$, где $\phi(x)$ - канторова лестница. Несложно понять, что это непрерывная, возрастающая на $[0; 1]$ биекция. Посмотрим на $\psi([0; 1] \bs C)$, в частности на меру этого образа:
	\[
		\forall x \in \ps{\frac{1}{3}; \frac{2}{3}} \Ra \psi(x) \in \ps{\frac{5}{12}; \frac{7}{12}}
	\]
	Была мера отрезка $1/3$, а стала $1/6$. Аналогично со всеми остальными имеем:
	\[
		\mu(\psi([0; 1] \bs C)) = \frac{1}{2}\mu([0; 1] \bs C) = \frac{1}{2}
	\]
	Это даёт нам возможность оценить меру $\mu(\psi(C))$:
	\[
		\mu(\psi(C)) = \mu([0; 1] \bs \psi([0; 1] \bs C)) = \frac{1}{2}
	\]
	То есть $\psi(C)$ - это измеримое множество положительной конечной меры. Значит, существует $B \subset \psi(C)$ - неизмеримое подмножество. Наша ставка заключается в том, чтобы получить $f \circ g = \chi_B$, соблюдая при этом все условия. Возьмём за $g := \psi^{-1}$, а за $f$ тогда $\chi_A$, где $A = g(B)$. По теореме об обратной функции про $g$ всё ясно, а вот измеримость $f$ следует из того факта, что $0 \le \mu(A) \le \mu(C) = 0$.
\end{example}

\begin{theorem}
	Если $\{f_m\}_{m = 1}^\infty$ - последовательность измеримых на $E \subset \R^n$ функций и при этом
	\[
		\forall x \in E\ \exists \liml_{m \to \infty} f_m(x) = f(x)
	\]
	то $f(x)$ тоже измерима на $E$.
\end{theorem}

\begin{proof}
	Покажем, что из измеримости $\forall m \in \N\ f_m$ на $E$ следует измеримость функции $\phi_t(x)$ следующего вида:
	\[
		\phi_t(x) := \sup_{m \ge t} f_m(x)
	\]
	Действительно, воспользуемся одним из эквивалентных определений измеримой функции и посмотрим на лебегово множество:
	\[
		\{x \in E \colon \sup_{m \ge t} f_m(x) \le a\} = \bigcap_{m = t}^\infty \{x \in E \colon f_m(x) \le a\} \text{ - измеримо}
	\]
	Отсюда функция, определяемая как $g(x) = \varlimsup_{m \to \infty} f_m(x) = \inf_{m \in \N} \sup_{k \ge m} f_k(x)$ тоже измерима и равна $f(x)$.
\end{proof}

\begin{definition}
	\textit{Ступенчатой функцией} будем называть измеримую функцию, имеющую конечное или счётное множество конечных значений.
\end{definition}

\begin{note}
	Иначе говоря, ступенчатая функция $h(x)$ - это такая, которая представима в следующем виде:
	\[
		h(x) = \sum_{k = 1}^\infty c_k \chi_{E_k}(x),\ E_k \text{ - измеримо}
	\]
\end{note}

\begin{theorem}
	Если $f \colon E \to [0; +\infty)$ измерима на множестве $E \subset \R^n$, то она представима пределом равномерно сходящейся на $E$ последовательности ступенчатых функций $\{h_m(x)\}_{m = 1}^\infty$ неубывающей (невозрастающей) для любого $x \in E$.
\end{theorem}