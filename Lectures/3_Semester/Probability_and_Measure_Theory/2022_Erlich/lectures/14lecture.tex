\textcolor{red}{Тут начало 14й лекции. Покуда этот текст тут, далее я не гарантирую качество материала.}

\begin{theorem} (<<Теорема Эрлиха>>, критерий сходимости по мере)
	Пусть $\mu(X) < \infty$. Если $f_n, f$ --- это измеримые функции, то имеет место эквивалентность:
	\[
		f_n \Ra^\mu f \Longleftrightarrow \forall \{n_k\}_{k = 1}^\infty\ \exists \{n_{k_m}\}_{m = 1}^\infty \such f_{n_{k_m}} \to f \text{ почти всюду}
	\]
\end{theorem}

\begin{proof}
	Проведём доказательство в каждую из сторон по отдельности:
	\begin{itemize}
		\item $\Ra$ Так как $f_n \Ra^\mu f$, то по теореме Рисса уже следует требуемое (сходимость по мере сохраняется, если перейти к произвольной подпоследовательности).
		
		\item $\La$ Предположим противное, то есть $f_n \centernot{\Ra^\mu} f$. По определению сходимости по мере это означает
		\[
			\exists \eps_0 > 0,\ \exists \delta_0 > 0,\ \exists \{n_k\}_{k = 1}^\infty \such (\forall k \in \N\ \ n_{k + 1} > n_k) \wedge \mu\{x \in X \colon |f_{n_k}(x) - f(x)| > \eps_0\} > \delta_0
		\]
		При этом по условию должна существовать вот такая подподпоследовательность:
		\[
			\exists \{n_{k_m}\}_{m = 1}^\infty \such f_{n_{k_m}} \to f \text{ почти всюду}
		\]
		По критерию сходимости в силу $\mu(X) < \infty$ имеем
		\[
			\lim_{l \to \infty} \mu\ps{\bigcup_{m = l}^\infty \{x \in X \colon |f_{n_{k_m}}(x) - f(x)| > \eps_0\}} = 0
		\]
		Однако, мера каждого множества в объединении будет больше $\delta_0 > 0$. Получено противоречие.
	\end{itemize}
\end{proof}

\begin{definition}
	Измеримые функции $f, g$ на измеримом пространстве $(X, M, \mu)$ называются \textit{эквивалентными}, если выполнено равенство:
	\[
		\mu\{x \in X \colon f(x) \neq g(x)\} = 0
	\]
	Обозначается как $f \sim g$
\end{definition}

\begin{note}
	Вполне справедливо ждать от сходимости как \textit{явления} следующих свойств:
	\begin{enumerate}
		\item Единственность предела с точностью до эквивалентности измеримых функций
		
		\item Линейность сходимости
		
		\item Непрерывность композиции
		
		\item Непрерывность произведения и деления (второе с оговоркой про нули)
	\end{enumerate}
\end{note}

\begin{theorem}
	Для сходимости почти всюду верны все вышеперечисленные свойства в таких формулировках:
	\begin{enumerate}
		\item Если $f_n \to f$ и $f_n \to g$, то $f \sim g$
		
		\item Если $f_n \to f$ и $g_n \to g$, то $\forall \alpha, \beta \in \R$ верно, что $\alpha f_n + \beta g_n \to \alpha f + \beta g$
		
		\item Если $h \colon G \to \R$ --- непрерывная на открытом множестве $G$ функция, а $f_n, f \colon X \to G$ и $f_n \to f$, то имеет место сходимость $h(f_n) \to h(f)$
		
		\item Если $f_n \to f$ и $g_n \to g$, то $f_n \cdot g_n \to f \cdot g$ почти всюду на $X$ и $f_n / g_n \to f / g$ почти всюду на $\{x \in X \colon g(x) \neq 0\}$
	\end{enumerate}
\end{theorem}

\begin{proof}
	В одну сторону очевидно, в обратную тривиально.
	\begin{enumerate}
		\item Обозначим $E_f, E_g \subseteq X$ --- множества точек, где точно есть сходимость. Тогда $f(x) = g(x)$ при $x \in E_f \cap E_g$, а также $\mu(X \bs E_f) = \mu(X \bs E_g) = 0$. Остаётся заметить, что
		\[
			\mu(E \bs (E_f \cap E_g)) \le \mu(E \bs E_f) + \mu(E \bs E_g) = 0
		\]
		
		\item Аналогично первому пункту
		
		\item Аналогично первому пункту
		
		\item Аналогично первому пункту
	\end{enumerate}
\end{proof}

\begin{note}
	Верны ли все свойства для сходимости по мере? Оказывается, что не всё так просто, это показывает следующий пример.	
\end{note}

\begin{example}
	Рассмотрим измеримое пространство $(\R, M, \mu)$ ($M$ --- измеримые множества, $\mu$ --- классическая мера Лебега). Проверим выполнение непрерывности композиции на последовательности $f_n = x + 1 / n$. Она, идейно, должна сходится к $f(x) = x$, что и наблюдается:
	\[
		\forall \eps > 0\ \ \mu\{x \in X \colon |f_n(x) - f(x)| > \eps\} \xrightarrow[n \to \infty]{} 0
	\]
	Посмотрим композицию с непрерывной функцией $h(x) = x^2$. Тогда
	\[
		h(f_n(x)) = x^2 + 2x\frac{1}{n} + \frac{1}{n^2}
	\]
	Внутри интересующего нас множества будет вот такой модуль:
	\[
		|h(f_n(x)) - h(f(x))| = \md{2x\frac{1}{n} + \frac{1}{n^2}} \Ra \forall \eps > 0\ \ \mu\{x \in X \colon |h(f_n(x)) - h(f(x))| > \eps\} = +\infty
	\]
\end{example}

\begin{theorem}
	Для сходимости по мере верны все свойства из замечания, если $\mu(X) < \infty$
	\begin{enumerate}
		\item Если $f_n \Ra^\mu f$ и $f_n \Ra^\mu g$, то $f \sim g$
		
		\item Если $f_n \Ra^\mu f$ и $g_n \Ra^\mu g$, то $\forall \alpha, \beta \in \R$ верно, что $\alpha f_n + \beta g_n \Ra^\mu \alpha f + \beta g$
		
		
		\item Если $h \colon G \to \R$ --- непрерывная на открытом множестве $G$ функция, а $f_n, f \colon X \to G$ и $f_n \Ra^\mu f$, то имеет место сходимость $h(f_n) \Ra^\mu h(f)$
		
		\item Если $f_n \Ra^\mu f$ и $g_n \Ra^\mu g$, то $f_n \cdot g_n \Ra^\mu f \cdot g$ на $X$ и $f_n / g_n \Ra^\mu f / g$ на $\{x \in X \colon g(x) \neq 0\}$
	\end{enumerate}
\end{theorem}

\begin{proof}~
	\begin{enumerate}
		\item Применяем <<теорему Эрлиха>>
		
		\item Применяем <<теорему Эрлиха>>
		
		\item Чуть более подробно применим <<теорему Эрлиха>>. Сейчас мы имеем, что
		\[
			\forall \{n_k\}_{k = 1}^\infty\ \exists \{n_{k_m}\}_{m = 1}^\infty \such f_{n_{k_m}}(x) \to f(x) \text{ почти всюду}
		\]
		По свойствам сходимости почти всюду мы сразу же получаем $h(f_{n_{k_m}}(x)) \to h(f(x))$ почти всюду, что и было необходимо доказать.
		
		\item Аналогично через <<теорему Эрлиха>>
	\end{enumerate}
\end{proof}

\begin{theorem}
	Если задано $\sigma$-конечное пространство $(X, M, \mu)$, то для сходимости по мере верны первые 2 свойства из замечания.
	\begin{enumerate}
		\item Если $f_n \Ra^\mu f$ и $f_n \Ra^\mu g$, то $f \sim g$
		
		\item Если $f_n \Ra^\mu f$ и $g_n \Ra^\mu g$, то $\forall \alpha, \beta \in \R$ верно, что $\alpha f_n + \beta g_n \Ra^\mu \alpha f + \beta g$
	\end{enumerate}
\end{theorem}

\begin{proof}
	\begin{enumerate}
		\item Пусть $f_n \Ra^\mu f$ и $f_n \Ra^\mu g$. Заметим такое вложение:
		\begin{multline*}
			\forall \eps > 0\ \forall n \in \N\ \ \{x \in X \colon |f(x) - g(x)| > \eps\} \subseteq
			\\
			\set{x \in X \colon |f(x) - f_n(x)| > \frac{\eps}{2}} \cup \set{x \in X \colon |f_n(x) - g(x)| > \frac{\eps}{2}}
		\end{multline*}
		Мера последних множеств стремится к нулю при $n \to \infty$, а вложение остаётся всегда верным. Это возможно тогда и только тогда, когда мера вложенного множества просто ноль при любом $\eps > 0$.
		
		\item По определению распишем то, что мы хотим оценить:
		\[
			\forall \eps > 0\ \mu\{x \in X \colon |f_n(x) + g_n(x) - (f(x) + g(x))| > \eps\}
		\]
		Вспомним про неравенство треугольника:
		\[
			|f_n(x) + g_n(x) - f(x) - g(x)| \le |f_n(x) - f(x)| + |g_n(x) - g(x)|
		\]
		В силу того, что исходный модуль должен быть $> \eps$, то хотя бы одно из слагаемых в оценке сверху должно превосходить хотя бы половину от $\eps$. Отсюда вложение и оценка на меру:
		\begin{multline*}
			\mu\{x \in X \colon |(f_n + g_n)(x) - (f + g)(x)| > \eps\} \le
			\\
			\mu\{x \in X \colon |f_n(x) - f(x)| > \eps / 2\} + \mu\{x \in X \colon |g_n(x) - g(x)| > \eps / 2\} \xrightarrow[n \to \infty]{} 0
		\end{multline*}
	\end{enumerate}
\end{proof}

\subsection{Интеграл Лебега}

\begin{note}
	Основная идея интеграла Лебега идёт от того, что для интеграла Римана нам нужно было знать устройство множества $X$, из которого действует функция $f \colon X \to \R$. Это зачастую очень тяжело, а то и невозможно. Поэтому умный в гору не пойдёт, умный гору обойдёт --- будем суммировать исходя из разбиений по значениям, а не аргументам (ибо почти всегда нас интересуют функции, действующие в $\R$).
\end{note}

\begin{note}
	Интеграл Лебега можно вводить разными методами. Конкретно у нас, зафиксируем $(X, M, \mu)$ --- $\sigma$-конечное пространство. Более того, любая рассматриваемая функция --- измеримая.
\end{note}

\begin{definition}
	\textit{Носителем функции} $f \colon X \to \R$ называется множество точек, где она принимает ненулевые значения.
\end{definition}

\subsubsection*{Построение интеграла Лебега для простой функции}

\begin{definition}
	Функция $f$ называется \textit{простой}, если она представима в следующем виде:
	\[
		f(x) = \sum_{k = 1}^n c_k \chi_{E_k} (x)
	\]
	при этом $c_k \neq 0$, $\mu(E_k) < \infty$ и $E_i \cap E_j = \emptyset$
\end{definition}

\begin{note}
	Если $f$ проста, то её носитель имеет конечную меру.
\end{note}

\begin{definition}
	\textit{Интегралом Лебега} для простой функции $f$ на множестве $X$ называется такая величина:
	\[
		(L)\int_X fd\mu := \sum_{k = 1}^n c_k \mu(E_k)
	\]
\end{definition}

\begin{note}
	Буковку $(L)$ обычно опускают.
\end{note}

\begin{note}
	Наше определение самую малость безосновательно: почему разные суммы дают одинаковый результат? Это необходимо обосновать.
\end{note}

\begin{lemma}
	Для любой простой функции $f$ существует \textit{каноническое представление}, при котором
	\[
		f = \sum_{k = 1}^n c_k \chi_{E_k}(x)
	\]
	где $c_i \neq c_j$ и $c_1 < \ldots < c_n$.
\end{lemma}

\begin{proof}
	Заметим, что простая функция из определения обладает конечным числом значений. Чтобы получить каноническое представление, достаточно упорядочить эти значения $c_k$ и взять за $E_k = f^{-1}(c_k)$
\end{proof}

\begin{proposition}
	Определение интеграла Лебега для простой функции корректно.
\end{proposition}

\begin{proof}
	Предположим, есть суммы, чьи значения не равны друг другу, но обе должны быть интегралом Лебега:
	\[
		(L)\int_X fd\mu = \sum_{k = 1}^n c_k \mu(E_k) \wedge (L)\int_X fd\mu = \sum_{t = 1}^m d_t \mu(B_t)
	\]
	Заметим, что мы можем потребовать $c_i \neq c_j$ и $d_r \neq d_s$ для различных индексов соответственно, ибо если это не так, то без проблем можно собрать соответствующие слагаемые и получить новые разбиения. По сути мы свели суммы к \textit{перестановкам канонической} --- между $c_k$ и $d_t$ теперь есть биекция, а по ней должна быть биекция и у мер разбиений.
	
	Иное доказательство: показать равенство любой суммы с канонической.
\end{proof}

\begin{note}
	Интеграл Лебега можно брать по любому $E \in M$. Действительно, можно просто рассмотреть сужение нашего пространства до $E$, все свойства сохранятся.
\end{note}

\begin{theorem}
	Если $f$ и $g$ --- простые функции, то для интеграла Лебега имеет место \textit{линейность}:
	\[
		\forall \alpha, \beta \in \R\ \ \int_X (\alpha f(x) + \beta g(x))d\mu = \alpha \int_X fd\mu + \beta \int_X gd\mu
	\]
\end{theorem}

\begin{proof}
	Есть 2 факта, которые нужно объяснить:
	\begin{enumerate}
		\item Простота функции-линейной комбинации. Тут можно просто явно выписать представление. Пусть
		\[
			f = \sum_{k = 1}^n c_k \chi_{E_k};\ \ g = \sum_{t = 1}^m d_t \chi_{B_t}
		\]
		где $c_k, d_t \neq 0$. Если мы попробуем записать линейную комбинацию просто через всевозможные пересечения, то мы потеряем значения с симметрической разности носителей (то есть ненулевые значения, когда $x \in E_k \bs \bscup_{t = 1}^m B_t$). Поэтому дополним наши функции ещё слагаемыми:
		\[
			f = \sum_{k = 1}^{n + 1} c_k \chi_{E_k};\ \ g = \sum_{t = 1}^{m + 1} d_t \chi_{B_t};\ \ c_{n + 1} = d_{m + 1} = 0
		\]
		Тогда:
		\[
			\bscup_{k = 1}^{n + 1} E_k = \bscup_{t = 1}^{m + 1} B_t = X \Ra \alpha f + \beta g = \sum_{k = 1}^{n + 1} \sum_{t = 1}^{m + 1} (\alpha c_k + \beta d_t) \chi_{E_k \cap B_t}
		\]
		Понятно, что в этой сумме можно оставить слагаемые только с ненулевыми коэффициентами и это будет конечной суммой. Следовательно, линейная комбинация будет простой функцией.
		
		\item Равенство интегралов. Чтобы мы могли воспользоваться полученным представлением линейности, нам надо узнать, какие слагаемые <<плохие>>, то есть мера их множеств может оказаться бесконечной. К счастью, таким слагаемым может быть лишь одно --- это как раз $(\alpha c_{n + 1} + \beta d_{m + 1})\chi_{E_{n + 1} \cap B_{m + 1}}$ и оно нулевое, то есть можно рассмотреть разбиение без него:
		\[
			(L)\int_X (\alpha f + \beta g) d\mu = \ps{\sum_{k = 1}^{n + 1} \sum_{t = 1}^m + \sum_{k = 1 \over {t = m + 1}}^n} (\alpha c_k + \beta d_t) \mu(E_k \cap B_t)
		\]
		Распишем двойную сумму:
		\begin{multline*}
			\sum_{k = 1}^{n + 1} \sum_{t = 1}^m (\alpha c_k + \beta d_t)\mu(E_k \cap B_t) = \alpha \sum_{k = 1}^{n + 1} c_k \sum_{t = 1}^m \mu(E_k \cap B_t) + \beta \sum_{t = 1}^m d_t \sum_{k = 1}^{n + 1} \mu(E_k \cap B_t) =
			\\
			\alpha \sum_{k = 1}^{n + 1} c_k \mu(E_k \bs B_{m + 1}) + \beta \sum_{t = 1}^m d_t \mu(B_t) = \alpha \sum_{k = 1}^n c_k \mu(E_k \bs B_{m + 1}) + \beta \sum_{t = 1}^m d_t \mu(B_t)
		\end{multline*}
		Вторая сумма в точности такая, чтобы убрать все разности:
		\[
			\sum_{k = 1 \over {t = m + 1}}^n (\alpha c_k + \beta d_t)\mu(E_k \cap B_t) = \sum_{k = 1}^n (\alpha c_k)\mu(E_k \cap B_{m + 1}) = \alpha \sum_{k = 1}^n c_k \mu(E_k \cap B_{m + 1})
		\]
		Как итог:
		\[
			(L)\int_X (\alpha f + \beta g)d\mu = \alpha\sum_{k = 1}^n c_k\mu(E_k) + \beta\sum_{t = 1}^m d_t\mu(B_t) = \alpha\int_X fd\mu + \beta\int_X gd\mu
		\]
	\end{enumerate}
\end{proof}

\begin{theorem} (Свойства интеграла Лебега от простой функции)
	Пусть $f$ и $g$ --- простые функции. Тогда имеют место такие свойства:
	\begin{enumerate}
		\item Если $f \ge 0$, то $\int_X f(x)d\mu \ge 0$
		
		\item Если $f \ge g$, то $\int_X f(x)d\mu \ge \int_X g(x)d\mu$
		
		\item $\left|\int_X f(x)d\mu\right| \le \int_X |f(x)|d\mu$
		
		\item Если $X = A \sqcup B$, где $A, B \in M$, тогда
		\[
			\int_X fd\mu = \int_A fd\mu + \int_B fd\mu
		\]
	\end{enumerate}
\end{theorem}

\begin{proof}
	Тривиально.
\end{proof}

\begin{theorem}
	Пусть есть такие условия:
	\begin{enumerate}
		\item $E \in M$
		
		\item $g$ --- простая функция
		
		\item $\{g_n\}_{n = 1}^\infty$ --- неубывающая на $E$ последовательность простых функций, то есть
		\[
			\forall n \in \N\ \forall x \in E\ \ g_n(x) \le g_{n + 1}(x)
		\]
		
		\item $\forall x \in E\ \ \lim_{n \to \infty} g_n(x) \ge g(x)$ (допускается бесконечное значение предела)
	\end{enumerate}
	Тогда имеется неравенство:
	\[
		\lim_{n \to \infty} \int_E g_n(x)d\mu \ge \int_E g(x)d\mu
	\]
\end{theorem}

\begin{proof}
	Если предел интегралов бесконечен, то теорема очевидна. Рассмотрим конечный случай. Запишем каноническое разложение $g$:
	\[
		g(x) = \sum_{k = 1}^N a_k \chi_{E_k}
	\]
	где, из определения и условия, $0 < a_1 < \ldots < a_N$. Обозначим $F = \bscup_{k = 1}^N E_k$, зафиксируем $\eps > 0$ и посмотрим на такие $F_n$:
	\[
		F_n = \{x \in E \colon g(x) - g_n(x) \ge \eps\}
	\]
	Что можно сказать про $F_n$? Например, $F_n \supseteq F_{n + 1}$, а также $\bigcap_{n = 1}^\infty F_n = \emptyset$ (если это не так, то получим противоречие с 4м условием). Так как $F_n \subseteq F$, где $\mu(F) < \infty$, то имеет место непрерывность меры (эквивалентное $\sigma$-аддитивности свойство в такой ситуации). Стало быть
	\[
		\lim_{n \to \infty} \mu(F_n) = 0
	\]
	Дело осталось за малым - оценить интеграл $g$ сверху:
	\begin{multline*}
		\int_E g(x)d\mu = \int_{F_n} g(x)d\mu + \int_{F \bs F_n} g(x)d\mu \le \int_{F_n} g(x)d\mu + \int_F (g_n(x) + \eps)d\mu =
		\\
		\sum_{k = 1}^N a_k\mu(E_k \cap F_n) + \int_F g_n(x)d\mu + \eps\mu(F) \le a_N \mu(F_n) + \int_F g_n(x)d\mu + \eps\mu(F)
	\end{multline*}
	Так как неравенство верно при любом $\eps > 0$ и соответствующем $F_n$, то вначале предельный переход по $n$ даст такое неравенство:
	\[
		\int_E g(x)d\mu \le \lim_{n \to \infty} \int_F g_n(x)d\mu + \eps\mu(F)
	\]
	А переход к $\eps \to 0$ даст искомое.
\end{proof}